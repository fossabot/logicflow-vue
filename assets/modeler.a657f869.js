var ve=Object.defineProperty,ge=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var X=(c,o,s)=>o in c?ve(c,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[o]=s,Y=(c,o)=>{for(var s in o||(o={}))ye.call(o,s)&&X(c,s,o[s]);if(Q)for(var s of Q(o))Ce.call(o,s)&&X(c,s,o[s]);return c},ee=(c,o)=>ge(c,he(o));import"./modulepreload-polyfill.b7f2da20.js";import{a2 as be,j as M,a3 as T,S as xe,T as we,o as y,A as D,F as j,a4 as Fe,u as t,a as e,w as n,a5 as ke,B as te,a6 as Ee,c as L,a7 as Be,a8 as U,a9 as ze,aa as Ve,_ as le,t as x,b as g,ab as W,N as I,ac as ae,k as De,l as Me,I as G,d as K,m as Pe,ad as $e,ae as Ae,af as Le,ag as je,ah as Se,ai as Te,aj as Ue,r as Ie,ak as Ke,al as He,am as Ne,n as Oe,p as Ge,q as Re,s as We,an as Je,ao as qe,H as ne,v as Ze,x as Qe,y as Xe,z as Ye,ap as en,aq as nn,ar as on,M as tn,as as ln,at as an,D as un,E as sn,au as _n,av as cn,G as pn,O as rn,L as dn,J as mn,aw as fn,K as vn,i as gn}from"./vendor.7e66b76e.js";import{a as J,m as R,b as hn}from"./index.52ba00ed.js";const yn=["id"],Cn=new be([32,32,1]);function bn(){return"__"+Cn.next()}const oe=(c,o)=>{o.forEach(a=>a.del=!0),Object.keys(c).forEach(a=>{const u=o.find(f=>f.key===a);u?(u.value=c[a],u.del=!1):o.push({key:a,newKey:a.startsWith("__")?"":a,value:c[a],newValue:c[a],del:!1})});let s=o.length;for(let a=0;a<s;a++)o[a].del&&(o.splice(a,1),a--,s--);return o},q=M({props:{value:null},setup(c){const o=c,{id:s}=T.useInjectFormItemContext(),a=[],u=xe(oe(o.value,[]));we(()=>o.value,(l,i)=>{console.log(l,"->",i),oe(l,u)},{deep:!0});function f(){o.value[bn()]=""}function m(l){u.splice(u.findIndex(i=>i.key===l),1),delete o.value[l]}function v(l){if(l.key===l.newKey)return;const i=l.newKey;if(i.startsWith("__")){console.log("key \u4E0D\u80FD\u4EE5 __ \u5F00\u5934");return}if(u.find(w=>w.key===i)){console.log("\u5B58\u5728\u91CD\u590D\u7684 key");return}console.log("changeKey",l);const F=l.key;l.key=i,o.value[i]=l.value,delete o.value[F]}function h(l){l.value!==l.newValue&&(console.log("changeValue",l),o.value[l.key]=l.newValue)}return(l,i)=>{const F=Be,w=U,B=ze,C=te,z=Ve,b=le,k=Ee;return y(),D("div",ke({id:t(s)},l.$attrs),[(y(!0),D(j,null,Fe(t(u),_=>(y(),L(b,null,{default:n(()=>[e(z,{compact:""},{default:n(()=>[e(F,{dropdownMatchSelectWidth:!1,size:"small",value:_.newKey,"onUpdate:value":p=>_.newKey=p,options:a,onBlur:p=>v(_),style:{width:"calc(50% - 12px)"}},null,8,["value","onUpdate:value","onBlur"]),e(w,{value:_.newValue,"onUpdate:value":p=>_.newValue=p,onBlur:p=>h(_),size:"small",style:{width:"calc(50% - 12px)"}},null,8,["value","onUpdate:value","onBlur"]),e(C,{type:"text",size:"small",onClick:p=>m(_.key)},{icon:n(()=>[e(B)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),256)),e(C,{type:"dashed",size:"small",style:{width:"calc(100% - 24px)"},onClick:f},{icon:n(()=>[e(k)]),_:1})],16,yn)}}});const xn=M({setup(c){const o=J(),s=x("Default Properties Panel");return(a,u)=>{const f=U,m=I,v=ae,h=q,l=T;return y(),D(j,null,[g("h1",null,W(s.value),1),e(l,{layout:"vertical",class:"properties-panel-form",model:t(o),name:"ppform"},{default:n(()=>[e(m,{label:"\u7F16\u53F7",extra:"\u552F\u4E00\u6807\u8BC6"},{default:n(()=>[e(f,{value:t(o).id,"onUpdate:value":u[0]||(u[0]=i=>t(o).id=i)},null,8,["value"])]),_:1}),e(m,{label:"\u6587\u672C",name:"text"},{default:n(()=>[e(v,{value:t(o).text,"onUpdate:value":u[1]||(u[1]=i=>t(o).text=i),"auto-size":""},null,8,["value"])]),_:1}),e(m,{label:"\u6269\u5C55\u5C5E\u6027",name:"properties"},{default:n(()=>[e(h,{value:t(o).properties},null,8,["value"])]),_:1})]),_:1},8,["model"])],64)}}}),wn=M({setup(c){const o=J(),s=x("Process Properties Panel");return(a,u)=>{const f=U,m=I,v=q,h=T;return y(),D(j,null,[g("h1",null,W(s.value),1),e(h,{layout:"vertical",class:"properties-panel-form",model:t(o),name:"ppform"},{default:n(()=>[e(m,{label:"\u7F16\u53F7",extra:"\u6D41\u7A0B\u6A21\u578B\u7684\u552F\u4E00\u6807\u8BC6"},{default:n(()=>[e(f,{value:t(o).id,"onUpdate:value":u[0]||(u[0]=l=>t(o).id=l)},null,8,["value"])]),_:1}),e(m,{label:"\u6269\u5C55\u5C5E\u6027",name:"properties"},{default:n(()=>[e(v,{value:t(o).properties},null,8,["value"])]),_:1})]),_:1},8,["model"])],64)}}}),Fn=M({setup(c){const o=J(),s=x("User Task Properties Panel");return(a,u)=>{const f=U,m=I,v=ae,h=q,l=T;return y(),D(j,null,[g("h1",null,W(s.value),1),e(l,{layout:"vertical",class:"properties-panel-form",model:t(o),name:"ppform"},{default:n(()=>[e(m,{label:"\u7F16\u53F7",extra:"\u7528\u6237\u4EFB\u52A1\u7684\u552F\u4E00\u6807\u8BC6"},{default:n(()=>[e(f,{value:t(o).id,"onUpdate:value":u[0]||(u[0]=i=>t(o).id=i)},null,8,["value"])]),_:1}),e(m,{label:"\u6587\u672C",name:"text"},{default:n(()=>[e(v,{value:t(o).text,"onUpdate:value":u[1]||(u[1]=i=>t(o).text=i),"auto-size":""},null,8,["value"])]),_:1}),e(m,{label:"\u6269\u5C55\u5C5E\u6027",name:"properties"},{default:n(()=>[e(h,{value:t(o).properties},null,8,["value"])]),_:1})]),_:1},8,["model"])],64)}}});var kn={default:xn,top:wn,"bpmn:userTask":Fn},En={bpmn:kn};const Bn=K("\u5BFC\u5165 \u6A21\u578B\u6587\u4EF6\uFF08*.json\uFF09"),zn=K(" \u5BFC\u51FA \u6A21\u578B\u6587\u4EF6\uFF08*.json\uFF09 "),Vn=K(" \u5BFC\u51FA PNG \u6587\u4EF6 "),Dn=K(" \u4FDD\u5B58 "),Mn=g("svg",{class:"icon",viewBox:"100 100 810 810",width:"1em",height:"1em"},[g("path",{d:"M316 672h60c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8zM512 622c22.1 0 40-17.9 40-39 0-23.1-17.9-41-40-41s-40 17.9-40 41c0 21.1 17.9 39 40 39zM512 482c22.1 0 40-17.9 40-39 0-23.1-17.9-41-40-41s-40 17.9-40 41c0 21.1 17.9 39 40 39z"}),g("path",{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32z m-40 728H184V184h656v656z"}),g("path",{d:"M648 672h60c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8z"})],-1),Pn=g("svg",{class:"icon",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},[g("path",{d:"M144 112h232a8 8 0 0 1 8 8v48a8 8 0 0 1-8 8H221.255l216.716 216.716a8 8 0 0 1 0 11.313l-33.942 33.942a8 8 0 0 1-11.313 0L176 221.255V376a8 8 0 0 1-8 8h-48a8 8 0 0 1-8-8V144c0-17.673 14.327-32 32-32z m-32 536v232c0 17.673 14.327 32 32 32h232a8 8 0 0 0 8-8v-48a8 8 0 0 0-8-8H221.884l215.901-215.901a8 8 0 0 0 0-11.314l-33.941-33.941a8 8 0 0 0-11.314 0L176 803.374V648a8 8 0 0 0-8-8h-48a8 8 0 0 0-8 8z m690.744 200L586.529 631.785a7.999 7.999 0 0 1 0-11.314l33.941-33.941a8 8 0 0 1 11.314 0L848 802.747V648a8 8 0 0 1 8-8h48a8 8 0 0 1 8 8v232c0 17.673-14.327 32-32 32H648a8 8 0 0 1-8-8v-48a8 8 0 0 1 8-8h154.744zM912 376V144c0-17.673-14.327-32-32-32H648a8 8 0 0 0-8 8v48a8 8 0 0 0 8 8h155.373l-217.03 217.029a8 8 0 0 0 0 11.314l33.941 33.941a8 8 0 0 0 11.314 0L848 221.882V376a8 8 0 0 0 8 8h48a8 8 0 0 0 8-8z"})],-1),$n=g("svg",{class:"icon",viewBox:"100 100 820 820",width:"1em",height:"1em"},[g("path",{d:"M541.141333 268.864l61.717334 16.938667-132.394667 482.474666-61.717333-16.938666 132.394666-482.474667zM329.002667 298.666667l44.885333 45.610666-175.36 172.586667 175.04 167.573333-44.266667 46.229334L106.666667 517.504 329.002667 298.666667z m355.882666 0l222.336 218.837333L684.586667 730.666667l-44.266667-46.229334 175.018667-167.573333L640 344.277333 684.885333 298.666667z"})],-1),An=M({setup(c){const{exportPng:o,exportGraphRawData:s,showMiniMap:a,toggleMiniMap:u,zoomOut:f,zoomIn:m,resetZoom:v,fitView:h,modified:l,undoDisable:i,redoDisable:F,undo:w,redo:B,propertiesPanel:C,modelTypeOptions:z,modelType:b,changedModelType:k,codeDrawerVisible:_}=De("modeler_context");return(p,d)=>{const H=Pe,N=$e,r=te,O=Ae,P=Le,S=je,E=Se,Z=Te,ue=Ue,$=Ie,se=Ke,_e=He,ie=Ne,ce=Oe,pe=Ge,A=Re,re=We,de=Je,me=qe,fe=le;return y(),L(fe,{type:"flex",justify:"space-between"},{default:n(()=>[e($,null,{default:n(()=>[e(H,{onChange:t(k),dropdownMatchSelectWidth:!1,value:t(b),"onUpdate:value":d[0]||(d[0]=V=>Me(b)?b.value=V:null),options:t(z)},null,8,["onChange","value","options"]),e($,{size:0},{default:n(()=>[e(r,{disabled:""},{icon:n(()=>[e(N)]),_:1}),e(r,{disabled:""},{icon:n(()=>[e(O)]),_:1}),e(Z,{trigger:["click"]},{overlay:n(()=>[e(S,null,{default:n(()=>[e(P,{key:"json"},{default:n(()=>[Bn]),_:1})]),_:1})]),default:n(()=>[e(r,{id:"import"},{icon:n(()=>[e(E)]),_:1})]),_:1}),e(Z,{trigger:["click"]},{overlay:n(()=>[e(S,null,{default:n(()=>[e(P,{id:"exportRaw",key:"json",onClick:d[1]||(d[1]=V=>t(s)(t(b)+".json"))},{default:n(()=>[zn]),_:1}),e(P,{id:"exportPng",key:"png",onClick:d[2]||(d[2]=V=>t(o)(t(b)))},{default:n(()=>[Vn]),_:1})]),_:1})]),default:n(()=>[e(r,{id:"export"},{icon:n(()=>[e(ue)]),_:1})]),_:1})]),_:1}),e(r,{disabled:!t(l),type:"primary"},{icon:n(()=>[e(se)]),default:n(()=>[Dn]),_:1},8,["disabled"]),e($,{size:0},{default:n(()=>[e(r,{disabled:t(i),onClick:t(w)},{icon:n(()=>[e(_e)]),_:1},8,["disabled","onClick"]),e(r,{disabled:t(F),onClick:t(B)},{icon:n(()=>[e(ie)]),_:1},8,["disabled","onClick"])]),_:1}),e($,{size:0},{default:n(()=>[e(r,{onClick:t(f)},{icon:n(()=>[e(ce)]),_:1},8,["onClick"]),e(r,{onClick:t(m)},{icon:n(()=>[e(pe)]),_:1},8,["onClick"]),e(A,{title:"\u6062\u590D\u539F\u59CB\u5927\u5C0F\u548C\u4F4D\u7F6E"},{default:n(()=>[e(r,{onClick:t(v)},{icon:n(()=>[e(t(G),null,{component:n(()=>[Mn]),_:1})]),_:1},8,["onClick"])]),_:1}),e(A,{title:"\u81EA\u9002\u5E94\u5927\u5C0F"},{default:n(()=>[e(r,{id:"fitView",onClick:d[3]||(d[3]=V=>t(h)(100))},{icon:n(()=>[e(t(G),null,{component:n(()=>[Pn]),_:1})]),_:1})]),_:1})]),_:1}),e($,{size:0},{default:n(()=>[e(A,{title:"\u663E\u793A/\u9690\u85CF \u7F29\u7565\u56FE\u5BFC\u822A"},{default:n(()=>[e(r,{onClick:d[4]||(d[4]=V=>t(u)()),type:t(a)?"primary":"default"},{icon:n(()=>[e(re)]),_:1},8,["type"])]),_:1}),e(A,{title:"\u663E\u793A/\u9690\u85CF \u5C5E\u6027\u9762\u677F"},{default:n(()=>[e(r,{disabled:t(C).disabled,onClick:t(C).toggleCollapsed,type:t(C).collapsed?"default":"primary"},{icon:n(()=>[e(de)]),_:1},8,["disabled","onClick","type"])]),_:1}),e(r,{disabled:""},{icon:n(()=>[e(me)]),_:1}),e(A,{title:"\u67E5\u770B\u4EE3\u7801"},{default:n(()=>[e(r,{onClick:d[5]||(d[5]=V=>_.value=!0),type:t(_)?"primary":"default"},{icon:n(()=>[e(t(G),null,{component:n(()=>[$n]),_:1})]),_:1},8,["type"])]),_:1})]),_:1})]),_:1})]),_:1})}}});const Ln=M({setup(c){const o=new URLSearchParams(location.search),s=o.has("modelType")?o.get("modelType"):"bpmn",a=x(s),u=R.find(_=>_.name===a.value)||R[0],f=En[u.name],m=()=>{a.value&&(o.set("modelType",a.value),location.search=o.toString())},v=[];R.forEach(_=>{v.push({label:_.label,value:_.name})});const h=x(v),l=hn(u,f),{propertiesPanel:i}=l;ne.registerLanguage("json",Ze),ne.registerLanguage("xml",Qe);const F=rn.component,w=x(!1),B=x(""),C=x(!1),z=x(!1),b=()=>{var p,d;let _;C.value?_=(p=l.lf)==null?void 0:p.getGraphRawData():_=(d=l.lf)==null?void 0:d.getGraphData(),typeof _=="object"&&(_=JSON.stringify(_,null,2)),B.value=_};Xe("modeler_context",ee(Y({},l),{modelTypeOptions:h,modelType:a,changedModelType:m,codeDrawerVisible:w}));const k=x();return Ye(()=>{var p;if(!k.value){console.log("error container is null");return}const _={container:k.value,adjustEdgeStartAndEnd:!0,edgeTextDraggable:!0,keyboard:{enabled:!0},plugins:[en,nn,on,tn,ln,an]};l.initLogicFlow(_),z.value=!!((p=l.lf)!=null&&p.adapterOut)}),(_,p)=>{const d=dn,H=mn,N=fn,r=un,O=vn,P=I,S=sn;return y(),D(j,null,[e(r,{style:{height:"100%",width:"100%",margin:"0",overflow:"hidden"}},{default:n(()=>[e(d,{style:{background:"#fff",height:"48px","line-height":"48px",padding:"0 10px"}},{default:n(()=>[e(An)]),_:1}),e(r,{hasSider:""},{default:n(()=>[e(H,null,{default:n(()=>[g("div",{ref_key:"container",ref:k,style:{height:"100%",width:"100%",padding:"4px","box-shadow":"0 0 4px rgb(0 0 0 / 30%) inset",background:"#fff"}},null,512)]),_:1}),e(N,{collapsed:t(i).collapsed,"onUpdate:collapsed":p[0]||(p[0]=E=>t(i).collapsed=E),collapsible:"",collapsedWidth:"0",theme:"light",width:"240px",style:{"background-color":"#f8f8f8",border:"1px solid #ccc","overflow-x":"hidden","overflow-y":"auto"}},{default:n(()=>[(y(),L(cn,null,[(y(),L(_n(t(i).component)))],1024))]),_:1},8,["collapsed"])]),_:1})]),_:1}),e(S,{visible:w.value,"onUpdate:visible":p[2]||(p[2]=E=>w.value=E),title:"\u4EE3\u7801",placement:"right",size:"large",bodyStyle:{padding:0},onAfterVisibleChange:b},{extra:n(()=>[z.value?(y(),L(P,{key:0,label:"\u539F\u59CB\u4EE3\u7801",style:{margin:"0"}},{default:n(()=>[e(O,{checked:C.value,"onUpdate:checked":p[1]||(p[1]=E=>C.value=E),onChange:b},null,8,["checked"])]),_:1})):pn("",!0)]),default:n(()=>[e(t(F),{autodetect:"",code:B.value},null,8,["code"])]),_:1},8,["visible"])],64)}}});gn(Ln).mount("#app");
