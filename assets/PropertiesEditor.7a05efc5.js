import{I,d as V,F as E,r as F,g as z,o as d,c as v,h as D,i as U,u as h,a as u,w as i,m as $,B as P,k as W,e as b,l as j,n as q,p as L,q as M,s as N}from"./vendor.30a14a4b.js";const O=["id"],S=new I([32,32,1]);function T(){return"__"+S.next()}const w=(c,o)=>{o.forEach(n=>n.del=!0),Object.keys(c).forEach(n=>{const l=o.find(a=>a.key===n);l?(l.value=c[n],l.del=!1):o.push({key:n,newKey:n.startsWith("__")?"":n,value:c[n],newValue:c[n],del:!1})});let p=o.length;for(let n=0;n<p;n++)o[n].del&&(o.splice(n,1),n--,p--);return o},G=V({props:{value:null},setup(c){const o=c,{id:p}=E.useInjectFormItemContext(),n=[],l=F(w(o.value,[]));z(()=>o.value,(e,t)=>{console.log(e,"->",t),w(e,l)},{deep:!0});function a(){o.value[T()]=""}function y(e){l.splice(l.findIndex(t=>t.key===e),1),delete o.value[e]}function g(e){if(e.key===e.newKey)return;const t=e.newKey;if(t.startsWith("__")){console.log("key \u4E0D\u80FD\u4EE5 __ \u5F00\u5934");return}if(l.find(m=>m.key===t)){console.log("\u5B58\u5728\u91CD\u590D\u7684 key");return}console.log("changeKey",e);const r=e.key;e.key=t,o.value[t]=e.value,delete o.value[r]}function k(e){e.value!==e.newValue&&(console.log("changeValue",e),o.value[e.key]=e.newValue)}return(e,t)=>{const r=j,m=q,B=L,f=P,x=M,K=N,C=W;return d(),v("div",$({id:h(p)},e.$attrs),[(d(!0),v(D,null,U(h(l),s=>(d(),b(K,null,{default:i(()=>[u(x,{compact:""},{default:i(()=>[u(r,{dropdownMatchSelectWidth:!1,size:"small",value:s.newKey,"onUpdate:value":_=>s.newKey=_,options:n,onBlur:_=>g(s),style:{width:"calc(50% - 12px)"}},null,8,["value","onUpdate:value","onBlur"]),u(m,{value:s.newValue,"onUpdate:value":_=>s.newValue=_,onBlur:_=>k(s),size:"small",style:{width:"calc(50% - 12px)"}},null,8,["value","onUpdate:value","onBlur"]),u(f,{type:"text",size:"small",onClick:_=>y(s.key)},{icon:i(()=>[u(B)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),256)),u(f,{type:"dashed",size:"small",style:{width:"calc(100% - 24px)"},onClick:a},{icon:i(()=>[u(C)]),_:1})],16,O)}}});export{G as _};
