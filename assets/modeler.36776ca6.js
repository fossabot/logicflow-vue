import"./modulepreload-polyfill.b7f2da20.js";import{a3 as _e,j as $,a4 as I,P as de,U as ce,o as F,A as D,F as M,a5 as me,a as e,w as t,a6 as fe,u as n,B as Q,a7 as ve,c as L,a8 as ge,a9 as S,aa as he,ab as be,h as xe,s as w,b as k,t as O,N as K,ac as ee,d as h,ad as Fe,ae as ye,af as we,ag as ke,k as Ce,r as ze,I as W,ah as Ee,ai as Be,aj as De,ak as $e,al as Ae,am as Ue,an as Ve,p as Pe,ao as Le,ap as Me,aq as je,l as Te,m as Ie,n as Se,q as Ke,ar as Re,as as Ne,H as Y,v as Oe,x as He,y as Ge,z as Je,at as We,au as Ye,av as qe,M as Xe,aw as Ze,ax as Qe,ay as et,az as tt,aA as q,aB as nt,aC as ot,aD as lt,aE as at,D as st,E as ut,T as it,L as pt,G as rt,J as _t,K as dt,O as ct,i as mt}from"./vendor.e36da0d7.js";import{a as H,b as ft,m as X,c as vt}from"./index.4832ea22.js";const gt=["id"],ht=new _e([32,32,1]);function bt(){return"__"+ht.next()}const Z=(b,o)=>{o.forEach(l=>l.del=!0),Object.keys(b).forEach(l=>{const u=o.find(r=>r.key===l);u?(u.value=b[l],u.del=!1):o.push({key:l,newKey:l.startsWith("__")?"":l,value:b[l],newValue:b[l],del:!1})});let f=o.length;for(let l=0;l<f;l++)o[l].del&&(o.splice(l,1),l--,f--);return o},G=$({__name:"PropertiesEditor",props:{value:null},setup(b){const o=b,{id:f}=I.useInjectFormItemContext(),l=[],u=de(Z(o.value,[]));ce(()=>o.value,(a,d)=>{console.log(a,"->",d),Z(a,u)},{deep:!0});function r(){o.value[bt()]=""}function c(a){u.splice(u.findIndex(d=>d.key===a),1),delete o.value[a]}function g(a){if(a.key===a.newKey)return;const d=a.newKey;if(d.startsWith("__")){console.log("key \u4E0D\u80FD\u4EE5 __ \u5F00\u5934");return}if(u.find(y=>y.key===d)){console.log("\u5B58\u5728\u91CD\u590D\u7684 key");return}console.log("changeKey",a);const x=a.key;a.key=d,o.value[d]=a.value,delete o.value[x]}function _(a){a.value!==a.newValue&&(console.log("changeValue",a),o.value[a.key]=a.newValue)}return(a,d)=>{const x=ge,y=S,i=he,C=Q,E=be,z=xe,B=ve;return F(),D("div",fe({id:n(f)},a.$attrs),[(F(!0),D(M,null,me(u,s=>(F(),L(z,null,{default:t(()=>[e(E,{compact:""},{default:t(()=>[e(x,{dropdownMatchSelectWidth:!1,size:"small",value:s.newKey,"onUpdate:value":p=>s.newKey=p,options:l,onBlur:p=>g(s),style:{width:"calc(50% - 12px)"}},null,8,["value","onUpdate:value","onBlur"]),e(y,{value:s.newValue,"onUpdate:value":p=>s.newValue=p,onBlur:p=>_(s),size:"small",style:{width:"calc(50% - 12px)"}},null,8,["value","onUpdate:value","onBlur"]),e(C,{type:"text",size:"small",onClick:p=>c(s.key)},{icon:t(()=>[e(i)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),256)),e(C,{type:"dashed",size:"small",style:{width:"calc(100% - 24px)"},onClick:r},{icon:t(()=>[e(B)]),_:1})],16,gt)}}});const xt=$({__name:"default",setup(b){const o=H(),f=w("Default Properties Panel");return(l,u)=>{const r=S,c=K,g=ee,_=G,a=I;return F(),D(M,null,[k("h1",null,O(f.value),1),e(a,{layout:"vertical",class:"properties-panel-form",model:n(o),name:"ppform"},{default:t(()=>[e(c,{label:"\u7F16\u53F7",extra:"\u552F\u4E00\u6807\u8BC6"},{default:t(()=>[e(r,{value:n(o).id,"onUpdate:value":u[0]||(u[0]=d=>n(o).id=d)},null,8,["value"])]),_:1}),e(c,{label:"\u540D\u79F0",name:"text"},{default:t(()=>[e(g,{value:n(o).text,"onUpdate:value":u[1]||(u[1]=d=>n(o).text=d),"auto-size":""},null,8,["value"])]),_:1}),e(c,{label:"\u63CF\u8FF0",name:"text"},{default:t(()=>[e(g,{value:n(o).text,"onUpdate:value":u[2]||(u[2]=d=>n(o).text=d),"auto-size":""},null,8,["value"])]),_:1}),e(c,{label:"\u6269\u5C55\u5C5E\u6027",name:"properties"},{default:t(()=>[e(_,{value:n(o).properties},null,8,["value"])]),_:1})]),_:1},8,["model"])],64)}}}),Ft=$({__name:"top",setup(b){const o=H(),f=w("\u6D41\u7A0B\u8BE6\u7EC6\u4FE1\u606F");return(l,u)=>{const r=S,c=K,g=G,_=I;return F(),D(M,null,[k("h1",null,O(f.value),1),e(_,{layout:"vertical",class:"properties-panel-form",model:n(o),name:"ppform"},{default:t(()=>[e(c,{label:"\u7F16\u53F7",extra:"\u6D41\u7A0B\u6A21\u578B\u7684\u552F\u4E00\u6807\u8BC6"},{default:t(()=>[e(r,{value:n(o).id,"onUpdate:value":u[0]||(u[0]=a=>n(o).id=a)},null,8,["value"])]),_:1}),e(c,{label:"\u6269\u5C55\u5C5E\u6027",name:"properties"},{default:t(()=>[e(g,{value:n(o).properties},null,8,["value"])]),_:1})]),_:1},8,["model"])],64)}}}),yt=["src"],wt=h(" \u7528\u6237\u4EFB\u52A1 "),kt=h("\u62A2\u4EFB\u52A1"),Ct=h("\u4F1A\u7B7E"),zt=h("\u4EBA\u5458"),Et=h("\u89D2\u8272"),Bt=h("\u8868\u8FBE\u5F0F"),Dt=h("\u5355\u8868\u5355"),$t=h("\u590D\u5408\u8868\u5355"),At=$({__name:"userTask",setup(b){const o=H();return(f,l)=>{const u=S,r=K,c=ee,g=I,_=Fe,a=ye,d=we,x=G,y=ke;return F(),D(M,null,[k("h1",null,[k("img",{src:n(ft)},null,8,yt),wt]),e(y,null,{default:t(()=>[e(_,{key:"general",tab:"\u5E38\u89C4"},{default:t(()=>[e(g,{layout:"vertical",class:"properties-panel-form",model:n(o),name:"ppform"},{default:t(()=>[e(r,{label:"\u7F16\u53F7"},{default:t(()=>[e(u,{value:n(o).id,"onUpdate:value":l[0]||(l[0]=i=>n(o).id=i)},null,8,["value"])]),_:1}),e(r,{label:"\u540D\u79F0",name:"text"},{default:t(()=>[e(c,{value:n(o).text,"onUpdate:value":l[1]||(l[1]=i=>n(o).text=i),"auto-size":""},null,8,["value"])]),_:1}),e(r,{label:"\u63CF\u8FF0",name:"description"},{default:t(()=>[e(c,{value:n(o).properties.description,"onUpdate:value":l[2]||(l[2]=i=>n(o).properties.description=i),"auto-size":""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),e(_,{key:"userTaskInfo",tab:"\u53C2\u4E0E\u8005"},{default:t(()=>[e(g,{layout:"vertical",class:"properties-panel-form",name:"pppform",model:n(o).properties},{default:t(()=>[e(r,{label:"\u5206\u914D\u7B56\u7565"},{default:t(()=>[e(d,{placeholder:"\u62A2\u4EFB\u52A1/\u4F1A\u7B7E",value:n(o).properties.fpcl,"onUpdate:value":l[3]||(l[3]=i=>n(o).properties.fpcl=i)},{default:t(()=>[e(a,{value:"single"},{default:t(()=>[kt]),_:1}),e(a,{value:"complexus"},{default:t(()=>[Ct]),_:1})]),_:1},8,["value"])]),_:1}),e(r,{label:"\u53C2\u4E0E\u8005\u7C7B\u578B"},{default:t(()=>[e(d,{placeholder:"\u4EBA\u5458/\u89D2\u8272/\u8868\u8FBE\u5F0F",value:n(o).properties.zxrlx,"onUpdate:value":l[4]||(l[4]=i=>n(o).properties.zxrlx=i)},{default:t(()=>[e(a,{value:"users"},{default:t(()=>[zt]),_:1}),e(a,{value:"roles"},{default:t(()=>[Et]),_:1}),e(a,{value:"expression"},{default:t(()=>[Bt]),_:1})]),_:1},8,["value"])]),_:1}),e(r,{label:"\u8868\u8FBE\u5F0F",name:"text"},{default:t(()=>[e(c,{"auto-size":"",value:n(o).properties.zxr,"onUpdate:value":l[5]||(l[5]=i=>n(o).properties.zxr=i)},null,8,["value"])]),_:1}),e(r,{label:"\u63CF\u8FF0",name:"text"},{default:t(()=>[e(c,{"auto-size":"",value:n(o).properties.ms,"onUpdate:value":l[6]||(l[6]=i=>n(o).properties.ms=i)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),e(_,{key:"formConfig",tab:"\u8868\u5355"},{default:t(()=>[e(g,{layout:"vertical",class:"properties-panel-form",name:"fcform"},{default:t(()=>[e(r,{label:"\u8868\u5355\u6A21\u5F0F",extra:"\u5355\u8868\u5355/\u5DE5\u4F5C\u53F0"},{default:t(()=>[e(d,{placeholder:"\u5355\u8868\u5355/\u5DE5\u4F5C\u53F0\u52A0",value:n(o).properties.formtype,"onUpdate:value":l[7]||(l[7]=i=>n(o).properties.formtype=i)},{default:t(()=>[e(a,{value:"single"},{default:t(()=>[Dt]),_:1}),e(a,{value:"complexus"},{default:t(()=>[$t]),_:1})]),_:1},8,["value"])]),_:1}),e(r,{label:"\u8868\u5355"},{default:t(()=>[e(u,{placeholder:"\u8BF7\u8F93\u5165\u8868\u5355\u7EC4\u4EF6\u540D\u79F0\u6216\u8005url",value:n(o).properties.formurl,"onUpdate:value":l[8]||(l[8]=i=>n(o).properties.formurl=i)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(_,{key:"advanced",tab:"\u9AD8\u7EA7"},{default:t(()=>[e(g,{layout:"vertical",class:"properties-panel-form",model:n(o),name:"advform"},{default:t(()=>[e(r,{label:"\u5C5E\u6027",name:"properties"},{default:t(()=>[e(x,{value:n(o).properties},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})],64)}}});var Ut={default:xt,top:Ft,"bpmn:userTask":At},Vt={bpmn:Ut};const Pt=h("\u5BFC\u5165 \u6A21\u578B\u6587\u4EF6\uFF08*.json\uFF09"),Lt=h(" \u5BFC\u51FA \u6A21\u578B\u6587\u4EF6\uFF08*.json\uFF09 "),Mt=h(" \u5BFC\u51FA PNG \u6587\u4EF6 "),jt=h(" \u4FDD\u5B58 "),Tt=k("svg",{class:"icon",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},[k("path",{d:"M144 112h232a8 8 0 0 1 8 8v48a8 8 0 0 1-8 8H221.255l216.716 216.716a8 8 0 0 1 0 11.313l-33.942 33.942a8 8 0 0 1-11.313 0L176 221.255V376a8 8 0 0 1-8 8h-48a8 8 0 0 1-8-8V144c0-17.673 14.327-32 32-32z m-32 536v232c0 17.673 14.327 32 32 32h232a8 8 0 0 0 8-8v-48a8 8 0 0 0-8-8H221.884l215.901-215.901a8 8 0 0 0 0-11.314l-33.941-33.941a8 8 0 0 0-11.314 0L176 803.374V648a8 8 0 0 0-8-8h-48a8 8 0 0 0-8 8z m690.744 200L586.529 631.785a7.999 7.999 0 0 1 0-11.314l33.941-33.941a8 8 0 0 1 11.314 0L848 802.747V648a8 8 0 0 1 8-8h48a8 8 0 0 1 8 8v232c0 17.673-14.327 32-32 32H648a8 8 0 0 1-8-8v-48a8 8 0 0 1 8-8h154.744zM912 376V144c0-17.673-14.327-32-32-32H648a8 8 0 0 0-8 8v48a8 8 0 0 0 8 8h155.373l-217.03 217.029a8 8 0 0 0 0 11.314l33.941 33.941a8 8 0 0 0 11.314 0L848 221.882V376a8 8 0 0 0 8 8h48a8 8 0 0 0 8-8z"})],-1),It=k("svg",{class:"icon",viewBox:"100 100 820 820",width:"1em",height:"1em"},[k("path",{d:"M541.141333 268.864l61.717334 16.938667-132.394667 482.474666-61.717333-16.938666 132.394666-482.474667zM329.002667 298.666667l44.885333 45.610666-175.36 172.586667 175.04 167.573333-44.266667 46.229334L106.666667 517.504 329.002667 298.666667z m355.882666 0l222.336 218.837333L684.586667 730.666667l-44.266667-46.229334 175.018667-167.573333L640 344.277333 684.885333 298.666667z"})],-1),St=$({__name:"toolbar",setup(b){const o=Ce("modeler_context"),{exportPng:f,exportGraphRawData:l,showMiniMap:u,toggleMiniMap:r,scale:c,zoomOut:g,zoomIn:_,resetZoom:a,fitView:d,modified:x,undoDisable:y,redoDisable:i,undo:C,redo:E,propertiesPanel:z,modelType:B,codeDrawerVisible:s}=o;return(p,m)=>{const R=Ee,v=Q,N=Be,A=De,j=$e,U=Ae,J=Ue,te=Ve,V=Pe,ne=Le,oe=Me,le=je,ae=Te,P=Ie,se=Se,ue=Ke,ie=Re,pe=Ne,re=ze;return F(),L(re,null,{default:t(()=>[e(V,null,{default:t(()=>[e(v,{disabled:""},{icon:t(()=>[e(R)]),_:1}),e(v,{disabled:""},{icon:t(()=>[e(N)]),_:1}),e(J,{trigger:["click"]},{overlay:t(()=>[e(j,null,{default:t(()=>[e(A,{key:"json"},{default:t(()=>[Pt]),_:1})]),_:1})]),default:t(()=>[e(v,{id:"import"},{icon:t(()=>[e(U)]),_:1})]),_:1}),e(J,{trigger:["click"]},{overlay:t(()=>[e(j,null,{default:t(()=>[e(A,{id:"exportRaw",key:"json",onClick:m[0]||(m[0]=T=>n(l)(n(B)+".json"))},{default:t(()=>[Lt]),_:1}),e(A,{id:"exportPng",key:"png",onClick:m[1]||(m[1]=T=>n(f)(n(B)))},{default:t(()=>[Mt]),_:1})]),_:1})]),default:t(()=>[e(v,{id:"export"},{icon:t(()=>[e(te)]),_:1})]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(v,{disabled:!n(x),type:"primary"},{icon:t(()=>[e(ne)]),default:t(()=>[jt]),_:1},8,["disabled"])]),_:1}),e(V,null,{default:t(()=>[e(v,{disabled:n(y),onClick:n(C)},{icon:t(()=>[e(oe)]),_:1},8,["disabled","onClick"]),e(v,{disabled:n(i),onClick:n(E)},{icon:t(()=>[e(le)]),_:1},8,["disabled","onClick"])]),_:1}),e(V,null,{default:t(()=>[e(v,{onClick:n(g)},{icon:t(()=>[e(ae)]),_:1},8,["onClick"]),e(P,{title:"\u70B9\u51FB\u6B64\u5904\uFF0C\u6062\u590D\u539F\u59CB\u5927\u5C0F\u548C\u4F4D\u7F6E"},{default:t(()=>[e(v,{style:{padding:"4px"},onClick:n(a)},{default:t(()=>[h(O(n(c).percentage),1)]),_:1},8,["onClick"])]),_:1}),e(v,{onClick:n(_)},{icon:t(()=>[e(se)]),_:1},8,["onClick"]),e(P,{title:"\u81EA\u9002\u5E94\u5927\u5C0F"},{default:t(()=>[e(v,{id:"fitView",onClick:m[2]||(m[2]=T=>n(d)(100))},{icon:t(()=>[e(n(W),null,{component:t(()=>[Tt]),_:1})]),_:1})]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(P,{title:"\u663E\u793A/\u9690\u85CF \u7F29\u7565\u56FE\u5BFC\u822A"},{default:t(()=>[e(v,{onClick:m[3]||(m[3]=T=>n(r)()),type:n(u)?"primary":"default"},{icon:t(()=>[e(ue)]),_:1},8,["type"])]),_:1}),e(P,{title:"\u663E\u793A/\u9690\u85CF \u5C5E\u6027\u9762\u677F"},{default:t(()=>[e(v,{disabled:n(z).disabled,onClick:n(z).toggleCollapsed,type:n(z).collapsed?"default":"primary"},{icon:t(()=>[e(ie)]),_:1},8,["disabled","onClick","type"])]),_:1}),e(v,{disabled:""},{icon:t(()=>[e(pe)]),_:1}),e(P,{title:"\u67E5\u770B\u4EE3\u7801"},{default:t(()=>[e(v,{onClick:m[4]||(m[4]=T=>s.value=!0),type:n(s)?"primary":"default"},{icon:t(()=>[e(n(W),null,{component:t(()=>[It]),_:1})]),_:1},8,["type"])]),_:1})]),_:1})]),_:1})}}});const Kt=$({__name:"index",setup(b){const o=w(),f=w(30),l=new URLSearchParams(location.search),u=l.has("modelType")?l.get("modelType"):"bpmn",r=w(u),c=X.find(s=>s.name===r.value)||X[0],g=Vt[c.name],_=vt(c,g),{propertiesPanel:a}=_;Y.registerLanguage("json",Oe),Y.registerLanguage("xml",He);const d=ut.component,x=w(!1),y=w(""),i=w(!1),C=w(!1),E=()=>{var p,m;let s;i.value?s=(p=_.lf)==null?void 0:p.getGraphRawData():s=(m=_.lf)==null?void 0:m.getGraphData(),typeof s=="object"&&(s=JSON.stringify(s,null,2)),y.value=s};function z(){if(o.value&&_.lf){const{width:s,height:p}=o.value.getBoundingClientRect();_.lf.resize(s-8,p-8)}}async function B(s){if(!(!o.value||!_.lf)&&(console.log("onResize",s,_.lf.graphModel.width),s[1]&&s[1].size)){const p=s[1].size;a.collapsed=p<5,f.value=p}}return Ge("modeler_context",Object.assign(_,{modelType:r,codeDrawerVisible:x})),Je(()=>{var m;if(!o.value){console.log("error container is null");return}const s={container:o.value,adjustEdgeStartAndEnd:!0,edgeTextDraggable:!0,keyboard:{enabled:!0},plugins:[We,Ye,qe,Xe,Ze,Qe]};_.initLogicFlow(s),C.value=!!((m=_.lf)!=null&&m.adapterOut);let p=!1;et(o.value,()=>{p||(p=!0,setTimeout(async()=>{p=!1,await it(),z()},500))})}),(s,p)=>{const m=pt,R=rt,v=_t,N=dt,A=K,j=ct;return F(),D(M,null,[e(v,{style:{height:"100%",width:"100%",margin:"0",overflow:"hidden"}},{default:t(()=>[e(m,{style:{background:"#fff",height:"42px","line-height":"32px",padding:"5px 10px"}},{default:t(()=>[e(St)]),_:1}),e(R,null,{default:t(()=>[e(n(tt),{class:"default-theme",onResized:B,"dbl-click-splitter":!1,"push-other-panes":!1},{default:t(()=>[e(n(q),{size:n(a).collapsed?100-f.value/100:100-f.value},{default:t(()=>[k("div",{ref_key:"container",ref:o,style:{height:"100%",width:"100%",padding:"4px","box-shadow":"0 0 4px rgb(0 0 0 / 30%) inset",background:"#fff"}},null,512)]),_:1},8,["size"]),nt(e(n(q),{size:n(a).collapsed?f.value/100:f.value,style:{padding:"10px","background-color":"#f8f8f8",overflow:"hidden auto"}},{default:t(()=>[(F(),L(at,null,[(F(),L(lt(n(a).component)))],1024))]),_:1},8,["size"]),[[ot,!n(a).collapsed]])]),_:1})]),_:1})]),_:1}),e(j,{visible:x.value,"onUpdate:visible":p[1]||(p[1]=U=>x.value=U),title:"\u4EE3\u7801",placement:"right",size:"large",bodyStyle:{padding:0},onAfterVisibleChange:E},{extra:t(()=>[C.value?(F(),L(A,{key:0,label:"\u539F\u59CB\u4EE3\u7801",style:{margin:"0"}},{default:t(()=>[e(N,{checked:i.value,"onUpdate:checked":p[0]||(p[0]=U=>i.value=U),onChange:E},null,8,["checked"])]),_:1})):st("",!0)]),default:t(()=>[e(n(d),{autodetect:"",code:y.value},null,8,["code"])]),_:1},8,["visible"])],64)}}});mt(Kt).mount("#app");
